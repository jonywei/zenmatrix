<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>{% block title %}ZenMatrix{% endblock %}</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <style> 
        [x-cloak] { display: none !important; } 
        .nav-item.active { background-color: #eff6ff; color: #2563eb; border-right: 4px solid #2563eb; font-weight: bold; }
        .nav-item { color: #4b5563; border-right: 4px solid transparent; }
        /* ç§»åŠ¨ç«¯åº•éƒ¨å®‰å…¨åŒºé€‚é… */
        .safe-bottom { padding-bottom: env(safe-area-inset-bottom); }
    </style>
</head>
<body class="bg-gray-100 text-gray-800 font-sans h-screen flex overflow-hidden" x-data="{ mobileMenuOpen: false }">

    <div class="md:hidden fixed w-full bg-white z-50 shadow-sm h-14 flex items-center justify-between px-4">
        <span class="font-black text-xl text-blue-600 tracking-tighter">ZenMatrix</span>
        <button @click="mobileMenuOpen = !mobileMenuOpen" class="text-gray-600 p-2 focus:outline-none">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
        </button>
    </div>

    <aside :class="mobileMenuOpen ? 'translate-x-0' : '-translate-x-full'" class="fixed inset-y-0 left-0 z-40 w-64 bg-white shadow-xl transform transition-transform duration-300 md:translate-x-0 md:static md:shadow-none border-r border-gray-200 flex flex-col pt-14 md:pt-0">
        <div class="h-16 flex items-center justify-center border-b border-gray-100 hidden md:flex">
            <h1 class="text-2xl font-black text-blue-600 tracking-tighter">ZenMatrix</h1>
        </div>
        
        <nav class="flex-1 overflow-y-auto py-4 space-y-1">
            <p class="px-6 text-xs font-bold text-gray-400 uppercase tracking-wider mt-2 mb-2">å·¥ä½œå°</p>
            <a href="/" class="nav-item flex items-center px-6 py-3 hover:bg-gray-50 transition {% if request.path == '/' %}active{% endif %}">
                <span class="mr-3 text-lg">ğŸ </span> ç»è¥æ¦‚è§ˆ
            </a>

            <p class="px-6 text-xs font-bold text-gray-400 uppercase tracking-wider mt-6 mb-2">ä¸šåŠ¡ä¸­å¿ƒ</p>
            <a href="/entry/" class="nav-item flex items-center px-6 py-3 hover:bg-green-50 transition {% if '/entry/' in request.path %}active{% endif %}">
                <span class="mr-3 text-lg">ğŸ“¥</span> <span class="font-bold text-green-700">å¿«é€Ÿå…¥åº“</span>
            </a>
            <a href="/sales/" class="nav-item flex items-center px-6 py-3 hover:bg-blue-50 transition {% if '/sales/' in request.path %}active{% endif %}">
                <span class="mr-3 text-lg">ğŸ’¸</span> <span class="font-bold text-blue-700">é”€å”®å¼€å•</span>
            </a>
            <a href="/rental/" class="nav-item flex items-center px-6 py-3 hover:bg-gray-50 transition {% if '/rental/' in request.path %}active{% endif %}">
                <span class="mr-3 text-lg">ğŸ”„</span> ç§Ÿèµç®¡ç†
            </a>
            <a href="/inventory/" class="nav-item flex items-center px-6 py-3 hover:bg-gray-50 transition {% if '/inventory/' in request.path %}active{% endif %}">
                <span class="mr-3 text-lg">ğŸ“¦</span> åº“å­˜æ¸…å•
            </a>

            <p class="px-6 text-xs font-bold text-gray-400 uppercase tracking-wider mt-6 mb-2">å®¢æˆ·ä¸èµ„é‡‘</p>
            <a href="/contact/" class="nav-item flex items-center px-6 py-3 hover:bg-gray-50 transition {% if '/contact/' in request.path %}active{% endif %}">
                <span class="mr-3 text-lg">ğŸ‘¥</span> å®¢æˆ·æ¡£æ¡ˆ
            </a>
            <a href="/analysis/account/" class="nav-item flex items-center px-6 py-3 hover:bg-gray-50 transition {% if '/account/' in request.path %}active{% endif %}">
                <span class="mr-3 text-lg">ğŸ¦</span> èµ„é‡‘è´¦æˆ·
            </a>
            <a href="/analysis/finance/" class="nav-item flex items-center px-6 py-3 hover:bg-gray-50 transition {% if '/finance/' in request.path %}active{% endif %}">
                <span class="mr-3 text-lg">ğŸ’°</span> æ¬ æ¬¾å¾€æ¥
            </a>
            <a href="/analysis/profit/" class="nav-item flex items-center px-6 py-3 hover:bg-gray-50 transition {% if '/profit/' in request.path %}active{% endif %}">
                <span class="mr-3 text-lg">ğŸ“ˆ</span> åˆ©æ¶¦æˆ˜æŠ¥
            </a>
        </nav>

        <div class="p-4 border-t border-gray-100">
            <a href="/profile/" class="flex items-center gap-3 px-2 py-2 rounded-lg hover:bg-gray-50 transition">
                <div class="w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center text-blue-600 font-bold text-sm">
                    {{ request.user.username|slice:":1"|upper }}
                </div>
                <div>
                    <p class="text-sm font-bold text-gray-700">{{ request.user.username }}</p>
                    <p class="text-xs text-gray-400">å½“å‰åœ¨çº¿</p>
                </div>
            </a>
        </div>
    </aside>

    <main class="flex-1 flex flex-col h-screen overflow-hidden bg-gray-50 relative">
        <div class="h-14 md:hidden flex-shrink-0"></div>
        
        <div class="flex-1 overflow-y-auto p-4 md:p-8 pb-24 md:pb-8">
            {% block content %}{% endblock %}
        </div>
    </main>

    <div class="md:hidden fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 p-3 z-50 flex gap-3 shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.05)] safe-bottom">
        <a href="/entry/" class="flex-1 bg-green-50 border border-green-200 text-green-700 rounded-xl flex flex-col items-center justify-center py-2 active:scale-95 transition shadow-sm">
            <span class="text-xl">ğŸ“¥</span>
            <span class="text-xs font-bold mt-1">å¿«é€Ÿå…¥åº“</span>
        </a>
        <a href="/sales/" class="flex-1 bg-blue-50 border border-blue-200 text-blue-700 rounded-xl flex flex-col items-center justify-center py-2 active:scale-95 transition shadow-sm">
            <span class="text-xl">ğŸ’¸</span>
            <span class="text-xs font-bold mt-1">é”€å”®å¼€å•</span>
        </a>
        <a href="/profile/" class="w-16 bg-gray-50 border border-gray-200 text-gray-600 rounded-xl flex flex-col items-center justify-center py-2 active:scale-95 transition hover:bg-gray-100">
            <div class="w-6 h-6 rounded-full bg-indigo-600 text-white flex items-center justify-center text-xs font-bold shadow-sm">
                {{ request.user.initials|default:request.user.username|slice:":1"|upper }}
            </div>
            <span class="text-[10px] font-bold mt-1 text-gray-500">æˆ‘çš„</span>
        </a>
    </div>

    <div x-show="mobileMenuOpen" @click="mobileMenuOpen = false" class="fixed inset-0 bg-black bg-opacity-50 z-30 md:hidden" style="display: none;" x-transition.opacity></div>

</body>
</html>